# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# üö® PROMETHEUS ALERTING RULES - D√©tection d'anomalies ML
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

groups:

  - name: cv_model_alerts
    
    interval: 30s
    
    rules:
      - alert: DatabaseDisconnected
        expr: cv_database_connected == 0
        
        for: 1m
        
        labels:
          severity: critical
        
        annotations:
          summary: "Database connection lost"
          description: "PostgreSQL is unreachable. Feedback storage disabled."

# ajout ici mais inutilis√© pour le moment voir grafana

      - alert: alert_high_latency
        expr: rate(cv_inference_time_seconds_sum[5m]) / rate(cv_inference_time_seconds_count[5m]) > 2
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "Latence √©lev√©e d√©tect√©e"
          description: "Latence moyenne > 2s pendant 2 minutes"

      - alert: HighNegativeFeedback
        expr: (sum(rate(cv_feedback_total{type="negative"}[5m])) / sum(rate(cv_feedback_total[5m]))) > 0.3
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Taux √©lev√© de feedbacks n√©gatifs (>30%)"
          description: "Le taux de feedbacks n√©gatifs est de {{ $value | printf \"%.2f\" }}."
